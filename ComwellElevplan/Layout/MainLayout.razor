@inherits LayoutComponentBase
@inject NavigationManager Nav
@inject IJSRuntime JS

<div class="layout">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="branding">
      <div class="logo">
        <img src="https://img.icons8.com/ios-filled/24/000000/chef-hat.png" />
      </div>
      <div class="user-display">@userName - @userRole</div>
    </div>
    <nav class="menu">
      @* Check role case-insensitively *@
      @if (userRole?.ToLowerInvariant() == "admin")
      {
        
        <a href="/DashboardAdmin"><img src="https://img.icons8.com/ios-filled/20/ffffff/list.png" />
          Admin Dashboard
        </a>
        <a href="/admin/elevplan"><img src="https://img.icons8.com/ios-filled/20/ffffff/task.png" />
          Alle Elevplaner
        </a>
        <a href="/forum"><img src="https://img.icons8.com/ios-filled/20/ffffff/topic.png" />
          Forum (Mock)
        </a>
        <a href="/profil"><img src="https://img.icons8.com/ios-filled/20/ffffff/user.png" />
          Profil (Mock)
        </a>
      }
      else
      {
        <a href="/dashboard"><img src="https://img.icons8.com/ios-filled/20/ffffff/home.png" />
          Dashboard
        </a>
        <a href="/min-elevplan"><img src="https://img.icons8.com/ios-filled/20/ffffff/task.png" />
          Elevplan
        </a>
        <a href="/quiz"><img src="https://img.icons8.com/ios-filled/20/ffffff/book.png" />
          Quiz (Mock)
        </a>
        <a href="/leaderboard"><img src="https://img.icons8.com/ios-filled/20/ffffff/trophy.png" />
          Leaderboard (Mock)
        </a>
        <a href="/forum"><img src="https://img.icons8.com/ios-filled/20/ffffff/topic.png" />
          Forum (Mock)
        </a>
        <a href="deleopgaver"><img src="https://img.icons8.com/ios-filled/20/ffffff/upload.png" />
          Dele opgaver (Mock)
        </a>
        <a href="/profil"><img src="https://img.icons8.com/ios-filled/20/ffffff/user.png" />
          Profil (Mock)
        </a>
      }

      <div class="menu-footer">
        <a href="/opretuser"><img src="https://img.icons8.com/ios-filled/20/ffffff/add-administrator.png" />
          Opret Bruger (Admin)
        </a>
        <a href="settings"><img src="https://img.icons8.com/ios-filled/20/ffffff/settings.png"/>
          Indstillinger (Mock)
        </a>
        <a @onclick="Logout" class="logout-link">
          <img src="https://img.icons8.com/ios-filled/20/ffffff/exit.png"/>
           Log ud
        </a>
      </div>
    </nav>
  </aside>

  <!-- Main content -->
  <main class="main">
    <header class="topbar">
      <h2></h2>
    </header>

    <section class="content">
      @Body
    </section>
  </main>
</div>

@code {
  private string? userName;
  private string? userRole;

  protected override async Task OnInitializedAsync()
  {
    userName = await JS.InvokeAsync<string>("localStorage.getItem", "userName");
    userRole = await JS.InvokeAsync<string>("localStorage.getItem", "userRole");
  }

  private async Task Logout()
  {
    await JS.InvokeVoidAsync("localStorage.clear");
    Nav.NavigateTo("/");
  }
}
